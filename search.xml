<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>B站视频嵌入测试</title>
      <link href="/2022/07/17/B%E7%AB%99%E8%A7%86%E9%A2%91%E5%B5%8C%E5%85%A5%E6%B5%8B%E8%AF%95/"/>
      <url>/2022/07/17/B%E7%AB%99%E8%A7%86%E9%A2%91%E5%B5%8C%E5%85%A5%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<div align=center class="aspect-ratio">    <iframe src="https://www.bilibili.com/video/BV1U54y1H7YD?spm_id_from=333.999.0.0&vd_source=6b896a4b15e13fcb7be61dea153dfc50"     scrolling="no"     border="0"     frameborder="no"     framespacing="0"     high_quality=1    danmaku=1     allowfullscreen="true">     </iframe></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RHCA学习笔记|RH358</title>
      <link href="/2022/07/12/RHCA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-RH358/"/>
      <url>/2022/07/12/RHCA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-RH358/</url>
      
        <content type="html"><![CDATA[<h1 id="Red-Hat-Services-Management-and-Automation"><a href="#Red-Hat-Services-Management-and-Automation" class="headerlink" title="Red Hat Services Management and Automation"></a>Red Hat Services Management and Automation</h1><blockquote><ul><li><p>Service &#x2F; RHCE7</p><ul><li>man</li><li>–help</li></ul></li><li><p>Ansible &#x2F; RHCE8</p><ul><li><p><a href="https://docs.ansible.com/ansible/2.8/index.html#">https://docs.ansible.com/ansible/2.8/index.html#</a></p><ul><li><a href="https://docs.ansible.com/ansible/2.9/reference_appendices/playbooks_keywords.html">keywords</a><ul><li>name</li><li>hosts</li><li>tasks</li><li>vars</li><li>loop(for)</li></ul></li><li><a href="https://docs.ansible.com/ansible/2.9/modules/modules_by_category.html">Module Index</a></li></ul></li><li><p>ansible-doc</p><ul><li>&#96;&#96;&#96;bash<br>$ ansible-doc -l | grep KEYWORD<br>$ ansible-doc MODULE-NAME<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">本课程基于</span><br><span class="line"></span><br><span class="line">- 红帽 Ansible 引擎 2.9</span><br><span class="line"></span><br><span class="line">- 红帽企业 Linux 8.1</span><br><span class="line"></span><br><span class="line">**[kiosk@foundation]**</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">$ ls /content/courses/rh358/rhel8.1/grading-scripts/</span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul></blockquote><h2 id="1-管理网络服务"><a href="#1-管理网络服务" class="headerlink" title="1 管理网络服务"></a>1 管理网络服务</h2><blockquote><ul><li>Systemd回顾</li><li>NetworkManager回顾</li><li>自动化配置服务和网络接口</li></ul></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">-RHEL&gt;=7 /pid=1=systemd</span><br><span class="line"><span class="comment"># systemctl list-unit-files | grep KEYWORD</span></span><br><span class="line"><span class="comment"># systemctl status KEYWORD</span></span><br><span class="line"></span><br><span class="line">* <span class="comment"># systemctl enable --now DAEMON</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl enable DAEMON</span></span><br><span class="line">* <span class="comment"># systemctl restart DAEMON</span></span><br><span class="line"><span class="comment"># systemctl status DAEMON</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl get-default</span></span><br><span class="line"><span class="comment"># systemctl -t target</span></span><br><span class="line">-CLI</span><br><span class="line"><span class="comment"># systemctl isolate multi-user.target# init 3</span></span><br><span class="line">-GUI</span><br><span class="line"><span class="comment"># systemctl isolate graphical.target# init 5</span></span><br><span class="line"><span class="comment"># systemctl set-default multi-user.target</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl list-dependencies graphical.target  | grep target</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl status crond.service </span></span><br><span class="line"><span class="comment"># systemctl stop crond.service </span></span><br><span class="line"><span class="comment"># systemctl mask crond.service </span></span><br><span class="line"><span class="comment"># systemctl is-active crond.service </span></span><br><span class="line"><span class="comment"># systemctl start crond</span></span><br><span class="line"><span class="comment"># systemctl unmask crond.service </span></span><br><span class="line"><span class="comment"># systemctl start crond</span></span><br><span class="line"><span class="comment"># systemctl is-active crond.service</span></span><br></pre></td></tr></table></figure><h4 id="Controlling-Network-Services"><a href="#Controlling-Network-Services" class="headerlink" title="Controlling Network Services"></a><strong>Controlling Network Services</strong></h4><blockquote><ul><li><p><strong>doc</strong></p><p># grep -r BOOPRO &#x2F;usr&#x2F;share<br># vim &#x2F;usr&#x2F;share&#x2F;doc&#x2F;initscripts&#x2F;sysconfig.txt</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">USERCTL</span>=<span class="literal">yes</span>|<span class="literal">no</span></span><br></pre></td></tr></table></figure></li><li><p><strong>man</strong><br># man -k ifcfg<br># man nm-settings-ifcfg-rh</p></li></ul></blockquote><p><strong>[student@workstation ~]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lab servicemgmt-netservice start</span><br></pre></td></tr></table></figure><hr><p><strong>[root@workstation]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl status chronyd</span></span><br><span class="line"><span class="comment"># systemctl restart chronyd</span></span><br><span class="line"><span class="comment"># systemctl status chronyd</span></span><br></pre></td></tr></table></figure><p><strong>[root@servera]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># systemctl status chronyd</span></span><br><span class="line"><span class="comment"># systemctl start chronyd</span></span><br><span class="line"><span class="comment"># systemctl status chronyd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl is-enabled chronyd</span></span><br><span class="line"><span class="comment"># reboot</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># systemctl is-active chronyd</span></span><br></pre></td></tr></table></figure><p><strong>[student@workstation ~]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lab servicemgmt-netservice finish</span><br></pre></td></tr></table></figure><h4 id="Configuring-Network-Interfaces"><a href="#Configuring-Network-Interfaces" class="headerlink" title="Configuring Network Interfaces"></a><strong>Configuring Network Interfaces</strong></h4><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ MANWIDTH=120 man nmcli | grep nmcli.*add</span><br></pre></td></tr></table></figure></blockquote><p><strong>[student@workstation ~]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lab servicemgmt-netreview start</span><br></pre></td></tr></table></figure><p><strong>[root@servera]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ip link</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nmcli con show</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nmcli con add con-name eth1 \</span></span><br><span class="line"><span class="built_in">type</span> ethernet \</span><br><span class="line">ifname eth1</span><br><span class="line"></span><br><span class="line"><span class="comment"># nmcli con show</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nmcli con mod eth1 ipv4.addresses 192.168.0.1/24 \</span></span><br><span class="line">ipv4.method manual</span><br><span class="line"><span class="comment"># cat /etc/sysconfig/network-scripts/ifcfg-eth1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nmcli con up eth1</span></span><br><span class="line"><span class="comment"># ip addr show dev eth1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ping -c 2 192.168.0.1</span></span><br><span class="line"><span class="comment"># echo $?</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ip route</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cat /etc/resolv.conf</span></span><br></pre></td></tr></table></figure><p><strong>[student@workstation ~]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lab servicemgmt-netreview finish</span><br></pre></td></tr></table></figure><h4 id="指导练习-自动化配置服务和网络接口"><a href="#指导练习-自动化配置服务和网络接口" class="headerlink" title="指导练习: 自动化配置服务和网络接口"></a><strong style='color: #1A97D5'>指导练习: 自动化配置服务和网络接口</strong></h4><blockquote><ul><li>roles:<br>- rhel-system-roles.<code>network</code> </li><li>-m <code>shell</code> -a ‘nmcli …’</li><li>-m <code>nmcli</code> -a ‘…’                            # pkg</li></ul></blockquote><hr><p><strong>[student@workstation]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lab servicemgmt-automation start</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ansible-playbook confignet.yml</span><br></pre></td></tr></table></figure><p><strong>[student@workstation]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lab servicemgmt-automation finish</span><br></pre></td></tr></table></figure><h2 id="2-配置网络聚合-配置网络Team"><a href="#2-配置网络聚合-配置网络Team" class="headerlink" title="2 配置网络聚合 配置网络Team"></a>2 配置网络聚合 配置网络Team</h2><blockquote><ul><li>管理网络Team</li><li>自动化网络Team</li></ul></blockquote><blockquote><p>带外管理，vnc</p></blockquote><blockquote><p>VIP - [ eth0 + eth1 ]</p><p>RHEL&lt;&#x3D;6 <code>bond</code>, RHEL&gt;&#x3D;7 <code>team</code></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># man -k nmcli</span></span><br><span class="line"><span class="comment"># man nmcli-examples | grep -A 2 nmcli.*team</span></span><br><span class="line">  $ nmcli con add <span class="built_in">type</span> team con-name `Team1` ifname `Team1` config `team1-master-json.conf`</span><br><span class="line">  $ nmcli con add <span class="built_in">type</span> ethernet con-name Team1-slave1 ifname `em1` master `Team1`</span><br><span class="line">  $ nmcli con add <span class="built_in">type</span> ethernet con-name Team1-slave2 ifname `em2` master `Team1`</span><br><span class="line">  </span><br><span class="line"><span class="comment"># man -k team</span></span><br><span class="line"><span class="comment"># man teamd.conf | grep backup</span></span><br><span class="line">  <span class="string">&quot;runner&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;activebackup&quot;</span>&#125;,</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-RHEL=7</span><br><span class="line"><span class="comment"># nmcli con add \</span></span><br><span class="line"><span class="built_in">type</span> team \</span><br><span class="line">con-name Team1 \</span><br><span class="line">ifname Team1 \</span><br><span class="line">config <span class="string">&#x27;&quot;runner&quot;: &#123;&quot;name&quot;: &quot;activebackup&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">-RHEL=8</span><br><span class="line"><span class="comment"># nmcli con add type team con-name Team1 ifname Team1 team.runner activebackup</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nmcli con add type ethernet con-name Team1-slave1 ifname eth1 master Team1</span></span><br><span class="line"><span class="comment"># nmcli con add type ethernet con-name Team1-slave2 ifname eth2 master Team1</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nmcli dev status </span></span><br><span class="line"><span class="comment"># ls /etc/sysconfig/network-scripts/ifcfg-*</span></span><br><span class="line"><span class="comment"># nmcli connection up Team1-slave1</span></span><br><span class="line"><span class="comment"># nmcli connection up Team1-slave2</span></span><br><span class="line"><span class="comment"># nmcli dev status </span></span><br><span class="line"><span class="comment"># cat -n /etc/sysconfig/network-scripts/ifcfg-Team1</span></span><br><span class="line"><span class="comment"># man nmcli | grep nmcli.*mod</span></span><br><span class="line"><span class="comment"># nmcli connection mod Team1 ipv4.method manual ipv4.addresses 10.1.1.1/8</span></span><br><span class="line"><span class="comment"># nmcli connection up Team1</span></span><br><span class="line"><span class="comment"># ip a s | grep -w inet</span></span><br><span class="line"><span class="comment"># ping -c 4 10.1.1.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># teamdctl Team1 state</span></span><br><span class="line"><span class="comment"># nmcli connection down Team1-slave1</span></span><br><span class="line"><span class="comment"># teamdctl Team1 state</span></span><br><span class="line"><span class="comment"># ping -c 4 10.1.1.1</span></span><br></pre></td></tr></table></figure><h2 id="3-管理DNS和DNS服务器"><a href="#3-管理DNS和DNS服务器" class="headerlink" title="3 管理DNS和DNS服务器"></a>3 管理DNS和DNS服务器</h2><h3 id="DNS（domain-name-system）概念"><a href="#DNS（domain-name-system）概念" class="headerlink" title="DNS（domain name system）概念"></a>DNS（domain name system）概念</h3><ul><li><p>早期使用hosts文件解析域名</p><p>具有主机名称重复、维护困难等困难</p></li><li><p>使用分布式&#x2F;层次性较强的DNS解决调度时，高并发也不会出现问题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8.8.8.8</span><br><span class="line">114.114.114.114</span><br></pre></td></tr></table></figure></li></ul><h3 id="DNS作用"><a href="#DNS作用" class="headerlink" title="DNS作用"></a>DNS作用</h3><ul><li><p>正向解析：根据主机名称（域名）查找对应ip</p></li><li><p>反向解析：根据ip查找对应的主机域名</p></li></ul><h3 id="域名空间机构"><a href="#域名空间机构" class="headerlink" title="域名空间机构"></a>域名空间机构</h3><p>分布式&#x2F;层次性的体现</p><blockquote><p><code>.</code> 根域</p><p><code>com.</code> 顶级域（包括 组织域.org、国家域&#x2F;地区域、反向域）</p><p><code>mi.com.</code>二级域</p><p><code>mail.mi.com.</code>三级域（或主机名）</p><blockquote><p>如果顶级域不算的话，往下就是一级域二级域。</p></blockquote><p>主机名.DNS后缀 &#x3D; FQDN（完全合格域名）</p><p>如：FQDN<a href="http://www.mi.com/">www.mi.com</a>.</p></blockquote><h3 id="DNS查询过程"><a href="#DNS查询过程" class="headerlink" title="DNS查询过程"></a>DNS查询过程</h3><blockquote><p>DNS解析</p><ul><li>递归查询，一级一级查找</li><li>迭代查询，并行</li></ul></blockquote><h3 id="DNS查询过程-1"><a href="#DNS查询过程-1" class="headerlink" title="DNS查询过程"></a>DNS查询过程</h3><blockquote><p>从查询方式上分：</p><ul><li>递归查询：客户端得到结果只能是成功或失败</li><li>迭代查询：服务器以最佳结果作答</li></ul><p>从查询内容上分：</p><ul><li>正向查询：由域名查找IP</li><li>反向查询：由IP查找域名</li></ul></blockquote><h3 id="DNS资源记录"><a href="#DNS资源记录" class="headerlink" title="DNS资源记录"></a>DNS资源记录</h3><blockquote></blockquote><blockquote><ul><li>&#x2F;etc&#x2F;hosts</li><li>&#x2F;etc&#x2F;resolv.conf</li></ul></blockquote><blockquote><ul><li>描述DNS服务</li><li>使用Unbound配置缓存名称服务器</li><li>排故DNS问题<ul><li><strong>host</strong> <a href="http://www.mi.com/">www.mi.com</a>,<br>host 172.25.254.250 172.25.254.254</li><li>nslookup <a href="http://www.mi.com/">www.mi.com</a>,<br>nslookup 172.25.254.250  172.25.254.254</li><li>dig <a href="http://www.mi.com/">www.mi.com</a> ,<br>dig -x 172.25.254.250  @172.25.254.254</li></ul></li><li>:triangular_flag_on_post: 使用BIND 9配置权威名称服务器</li><li>自动化配置DNS</li></ul></blockquote><table><thead><tr><th align="center">ID</th><th align="center">TYPE</th><th align="center">主配置文件*2</th><th align="center">区域文件（正向|反向）*2</th><th align="center">operation</th><th align="center">PKG</th></tr></thead><tbody><tr><td align="center">1</td><td align="center"><strong>Master</strong></td><td align="center">Y</td><td align="center">Y</td><td align="center">edit</td><td align="center">bind</td></tr><tr><td align="center">2</td><td align="center">Slave</td><td align="center">Y</td><td align="center">N</td><td align="center">copy</td><td align="center">bind</td></tr><tr><td align="center">3</td><td align="center">Cache</td><td align="center">Y</td><td align="center">N</td><td align="center">-</td><td align="center">unbound</td></tr><tr><td align="center">4</td><td align="center">Forward</td><td align="center">Y</td><td align="center">N</td><td align="center">-</td><td align="center">bind</td></tr></tbody></table><blockquote><p>$ hostname -s<kbd>Enter</kbd>www</p></blockquote><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ grep ^hosts /etc/nsswitch.conf</span><br><span class="line">hosts:      files dns myhostname</span><br><span class="line"></span><br><span class="line">- files = hosts</span><br><span class="line">- dns = resolve.conf</span><br></pre></td></tr></table></figure><ul><li>hosts<ul><li>Linux, MacOS - &#x2F;etc&#x2F;hosts</li><li>Windows - C:\windows\system32\drivers\etc\hosts</li></ul></li><li>dns<ul><li>permanent <ul><li>$ nmcli con mod CN ipv4.dns 8.8.8.8</li></ul></li><li>active <ul><li>$ cat &#x2F;etc&#x2F;resolve.conf</li></ul></li></ul></li></ul></blockquote><blockquote><p>:one: domain&#x2F;conf_file<em><strong>1</strong>permission</em>2, file “example.com.localhost”;  ,file “25.172.loopback”; </p><p>​:two: zone&#x2F;zone_file*<strong>2</strong>正向<code>lab.example.com.</code> ； 反向<code>25.172.in-addr.arpa.</code></p><p>​:three: recorder<br>​hostname<code>A</code> ip                    主机名解析成IP地址；<br>​rever<!--se hid `PTR` hostna-->me    IP 地址解析成主机名</p><p>​<code>SOA</code> &#x3D; <code>NS</code> &#x3D; servera.lab.example.com<code>.</code></p></blockquote><p><img src="https://gitee.com/suzhen99/redhat/raw/master/images/dns-lookups.svg" alt="dns-lookups"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">x:\&gt; <span class="title">ipconfig</span> /<span class="title">flushdns</span></span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">CLASS</th><th align="center"></th><th align="center">NID</th><th align="center">HID</th><th align="center">zone</th><th align="center">PTR</th></tr></thead><tbody><tr><td align="center">A</td><td align="center">10.1.2.3&#x2F;8</td><td align="center">10</td><td align="center">1.2.3</td><td align="center">10.in-addr.arpa.</td><td align="center">3.2.1</td></tr><tr><td align="center">B</td><td align="center">172.25.254.9&#x2F;16</td><td align="center">172.25</td><td align="center">254.9</td><td align="center">25.172.in-addr.arpa.</td><td align="center">9.254</td></tr><tr><td align="center">C</td><td align="center">192.168.9.10&#x2F;24</td><td align="center">192.168.9</td><td align="center">10</td><td align="center">9.168.192.in-addr.arpa.</td><td align="center">10</td></tr></tbody></table><h2 id="4-管理DHCP和IP地址分配"><a href="#4-管理DHCP和IP地址分配" class="headerlink" title="4 管理DHCP和IP地址分配"></a>4 管理DHCP和IP地址分配</h2><blockquote><ul><li>:triangular_flag_on_post: 使用DHCP配置IPv4地址分配</li><li>配置IPv6地址分配</li><li>自动化配置DHCP</li></ul></blockquote><blockquote><p>作用：分配网络参数，除了mac</p><p>工作原理：客户端广播，从先应答的服务器获得IP</p><p>协议：67&#x2F;UDP, 68&#x2F;UDP    <code>/etc/services</code></p><p>场景：无线路由、PXE、网络Ghost</p></blockquote><h2 id="5-管理打印机和打印文件"><a href="#5-管理打印机和打印文件" class="headerlink" title="5 管理打印机和打印文件"></a>5 管理打印机和打印文件</h2><blockquote><ul><li>配置和管理打印机</li><li>:triangular_flag_on_post: 自动化配置打印机</li></ul></blockquote><h2 id="6-配置邮件传输"><a href="#6-配置邮件传输" class="headerlink" title="6 配置邮件传输"></a>6 配置邮件传输</h2><blockquote><ul><li>配置一个仅发送邮件服务器</li><li>:triangular_flag_on_post: 自动配置Postfix</li></ul></blockquote><table><thead><tr><th align="center"></th><th align="center">Windows</th><th align="center">Linux</th><th align="center"></th></tr></thead><tbody><tr><td align="center">MTA<br>Mail Transport Agent</td><td align="center">Microssoft&#x2F;Exchange, <br>IBM&#x2F;Domino</td><td align="center">RHEL8 <strong>postfix</strong><br>RHEL&lt;&#x3D;7 sendmail<br>qmail</td><td align="center">邮局</td></tr><tr><td align="center">MDA<br>mail delivery agents</td><td align="center"></td><td align="center"></td><td align="center">邮递员</td></tr><tr><td align="center">MUA<br>mail user agent</td><td align="center">outlook, <br>foxmail</td><td align="center">GUI: evolution, thunderbird<br>CLI: <strong>mail</strong>, <strong>mutt</strong></td><td align="center">客户</td></tr></tbody></table><table><thead><tr><th align="center">PROTOCOL</th><th align="center"></th><th align="center"></th><th align="center">Package</th><th align="center">PORT</th></tr></thead><tbody><tr><td align="center">smtp</td><td align="center">发送</td><td align="center"></td><td align="center">postfix</td><td align="center">25</td></tr><tr><td align="center">imap</td><td align="center">接收</td><td align="center">同步sync</td><td align="center">dovecot</td><td align="center">143</td></tr><tr><td align="center">pop3</td><td align="center">接收</td><td align="center">拷贝copy</td><td align="center">dovecot</td><td align="center">110</td></tr></tbody></table><h2 id="7-配置MariaDB-SQL数据库"><a href="#7-配置MariaDB-SQL数据库" class="headerlink" title="7 配置MariaDB SQL数据库"></a>7 配置MariaDB SQL数据库</h2><blockquote><ul><li>:triangular_flag_on_post: 安装MariaDB数据库  </li><li>:triangular_flag_on_post: MariaDB中SQL管理</li><li>:triangular_flag_on_post: MariaDB用户和访问权限</li><li>备份和:triangular_flag_on_post: 恢复MariaDB</li><li>自动化部署MariaDB</li></ul></blockquote><blockquote><p>mysql -&#x3D;&gt; mariadb</p></blockquote><table><thead><tr><th align="center">SQL</th><th align="center">CMD（help CMD;）</th><th align="center">COMMENT</th></tr></thead><tbody><tr><td align="center">DDL</td><td align="center"><strong>create</strong>, alter, drop, <strong>show</strong>, use, DESCRIBE</td><td align="center">数据定义语言（结构）</td></tr><tr><td align="center">DML</td><td align="center"><strong>select</strong>, insert, update, delete</td><td align="center">数据操纵语言（内容）</td></tr><tr><td align="center">DCL</td><td align="center"><strong>grant</strong>, revoke</td><td align="center">数据控制语言（权限）</td></tr></tbody></table><h2 id="8-配置Web服务器"><a href="#8-配置Web服务器" class="headerlink" title="8 配置Web服务器"></a>8 配置Web服务器</h2><blockquote><ul><li>:triangular_flag_on_post: 使用Apache HTTPD配置一个基本Web服务器</li><li>:triangular_flag_on_post:使用Apache HTTPD配置和排故虚拟主机</li><li>:triangular_flag_on_post:配置Apache HTTPD HTTPS</li><li>:triangular_flag_on_post:使用Nginx配置一个Web服务器</li><li>自动化配置Web服务器</li></ul></blockquote><blockquote><p><code>当存在虚拟主机时，第一个虚拟主机会覆盖默认的web站点</code></p></blockquote><table><thead><tr><th align="center">TYPE</th><th align="center">PKG</th><th align="center">URL</th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">http</td><td align="center">httpd</td><td align="center"><a href="http://www0.lab.example.com/">http://www0.lab.example.com</a></td><td align="center">基于<code>名称</code>的虚拟主机</td><td align="center">80</td></tr><tr><td align="center">vhost</td><td align="center">httpd</td><td align="center"><a href="http://webapp0.lab.example.com/">http://webapp0.lab.example.com</a></td><td align="center">基于<code>名称</code>的虚拟主机</td><td align="center">80</td></tr><tr><td align="center">https</td><td align="center">mod_ssl</td><td align="center"><a href="https://www0.lab.example.com/">https://www0.lab.example.com</a></td><td align="center">基于<code>端口</code>的虚拟主机</td><td align="center">443</td></tr><tr><td align="center">permission</td><td align="center">http_manual</td><td align="center"><a href="http://www0.lab.example.com/manual">http://www0.lab.example.com/manual</a></td><td align="center">权限</td><td align="center"></td></tr></tbody></table><table><thead><tr><th align="center">密文</th><th align="center">明文</th><th align="center">公钥</th><th align="center">私钥</th></tr></thead><tbody><tr><td align="center">https</td><td align="center">http + ssl</td><td align="center">*.crt public &#x2F; Lock</td><td align="center">*.key private &#x2F; Key</td></tr><tr><td align="center">ssh</td><td align="center">telnet</td><td align="center"></td><td align="center"></td></tr></tbody></table><table><thead><tr><th align="center"></th><th align="center">优点</th><th align="center">缺点</th><th></th></tr></thead><tbody><tr><td align="center">apache</td><td align="center">稳定</td><td align="center">组件多，重量</td><td></td></tr><tr><td align="center">nginx</td><td align="center">反向代理，轻量</td><td align="center"></td><td></td></tr></tbody></table><h2 id="9-调整Web服务器流量"><a href="#9-调整Web服务器流量" class="headerlink" title="9 调整Web服务器流量"></a>9 调整Web服务器流量</h2><blockquote><ul><li>使用Varnish缓存静态内容</li><li>使用HAProxy终止HTTPS流量和配置负载均衡</li><li>自动化调整Web服务</li></ul></blockquote><h2 id="10-提前基于文件的网络存储"><a href="#10-提前基于文件的网络存储" class="headerlink" title="10 提前基于文件的网络存储"></a>10 提前基于文件的网络存储</h2><blockquote><ul><li>导出NFS文件系统</li><li>提供SMB文件共享</li><li>自动化提供文件存储</li></ul></blockquote><table><thead><tr><th align="center"></th><th align="center"></th><th align="center"></th><th align="center">Windows</th><th align="center">Linux</th><th align="center">TYPE</th></tr></thead><tbody><tr><td align="center">NAS</td><td align="center">Network Attached Storage</td><td align="center">网络附加存储</td><td align="center">samba(SMB)</td><td align="center">nfs</td><td align="center">dir</td></tr><tr><td align="center">SAN</td><td align="center">Storage Area Network</td><td align="center">存储区域网络</td><td align="center">target &#x2F; iSCSI</td><td align="center"></td><td align="center">block</td></tr></tbody></table><table><thead><tr><th align="center">SERVICE</th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">NAS&#x2F; directory</td><td align="center">samba</td><td align="center">nfs</td></tr><tr><td align="center">OS</td><td align="center">windows</td><td align="center">Like Unix</td></tr><tr><td align="center">Permission</td><td align="center">user</td><td align="center">ip, network, hostname, domain</td></tr><tr><td align="center">conf</td><td align="center">&#x2F;etc&#x2F;samba&#x2F;smb.cfg</td><td align="center">&#x2F;etc&#x2F;exports</td></tr><tr><td align="center">sharename</td><td align="center">[custom]</td><td align="center">&#x2F;path</td></tr><tr><td align="center">Pkg</td><td align="center">samba &#x2F; DAEMON,<br> samba-common &#x2F; conf, <br>samba-client &#x2F; smbclient</td><td align="center">nfs-utils</td></tr><tr><td align="center">DAEMON</td><td align="center">smb&#x2F;SERVICE, <br>nmb&#x2F;NAME</td><td align="center">nfs-server &#x2F; RHEL&gt;&#x3D;7, <br>nfs &#x2F; RHEL&lt;7</td></tr><tr><td align="center">firewall</td><td align="center">samba</td><td align="center">nfs -&#x3D;&gt; # mount,<br>[ port-mapper, mountd ] -&#x3D;&gt; $ showmount</td></tr><tr><td align="center">Client-cmd</td><td align="center">smbclient - like ftp interactive</td><td align="center">-</td></tr><tr><td align="center">filesystem</td><td align="center">cifs (cifs-utils)</td><td align="center">nfs</td></tr><tr><td align="center">autofs</td><td align="center">Yes</td><td align="center">Yes</td></tr></tbody></table><table><thead><tr><th align="center"></th><th align="center">Windows</th><th align="center">Linux</th><th align="center">QUOTA</th></tr></thead><tbody><tr><td align="center">Local</td><td align="center">ntfs</td><td align="center">ext4, xfs</td><td align="center">Y</td></tr><tr><td align="center">Remote</td><td align="center">cifs</td><td align="center">nfs</td><td align="center">N</td></tr></tbody></table><h2 id="11-访问基于块的网络存储"><a href="#11-访问基于块的网络存储" class="headerlink" title="11 访问基于块的网络存储"></a>11 访问基于块的网络存储</h2><blockquote><ul><li>提供iSCSI存储</li><li>访问iSCSI存储</li><li>自动化配置iSCSI Initiator</li></ul></blockquote><table><thead><tr><th align="center"></th><th align="center">Client</th><th align="center">Server</th></tr></thead><tbody><tr><td align="center">SAN &#x2F; block</td><td align="center">iscsi</td><td align="center">target</td></tr><tr><td align="center">CMD</td><td align="center">iscsiadm</td><td align="center">targetcli &#x2F; ls</td></tr><tr><td align="center"></td><td align="center">iscsiadm</td><td align="center">block</td></tr><tr><td align="center"></td><td align="center">lsblk</td><td align="center">iscsi - block</td></tr><tr><td align="center"></td><td align="center">fstab &#x2F; <code>_netdev</code></td><td align="center">iscsi - port</td></tr><tr><td align="center">acl</td><td align="center">&#x2F;etc&#x2F;iscsi&#x2F;init*</td><td align="center">iscsi - acl</td></tr><tr><td align="center">True</td><td align="center">iscsid</td><td align="center">target</td></tr><tr><td align="center">False</td><td align="center">iscsi</td><td align="center">targetd</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># iscsiadm --mode session -P 3</span></span><br></pre></td></tr></table></figure><h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="A0-step"><a href="#A0-step" class="headerlink" title="A0. step"></a>A0. step</h3><table><thead><tr><th align="center"></th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">1</td><td align="center">word</td><td align="center"></td></tr><tr><td align="center">2</td><td align="center"><kbd>Tab</kbd></td><td align="center"></td></tr><tr><td align="center">3</td><td align="center">man</td><td align="center"></td></tr><tr><td align="center">4</td><td align="center">echo $?</td><td align="center">&#x3D;&#x3D; 0</td></tr></tbody></table><h3 id="A1-红帽"><a href="#A1-红帽" class="headerlink" title="A1. 红帽"></a>A1. 红帽</h3><table><thead><tr><th align="center">ID</th><th align="center">URL</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">RH358</td><td align="center"><a href="https://www.redhat.com/zh/services/training/rh358-red-hat-services-management-automation">红帽服务管理与自动化</a></td><td align="center">课程代码</td></tr><tr><td align="center">EX358</td><td align="center"><a href="https://www.redhat.com/zh/services/training/ex358-red-hat-certified-specialist-services-management-automation-exam">红帽认证服务管理和自动化专家考试</a></td><td align="center">考试代码</td></tr></tbody></table><h3 id="A2-软件"><a href="#A2-软件" class="headerlink" title="A2. 软件"></a>A2. 软件</h3><table><thead><tr><th align="center"></th><th align="center"></th><th></th></tr></thead><tbody><tr><td align="center">1</td><td align="center">VMware</td><td>虚拟机</td></tr><tr><td align="center">2</td><td align="center"><a href="https://typora.io/">Typora</a></td><td>Markdown</td></tr><tr><td align="center">3</td><td align="center">Xmind</td><td>思维导图</td></tr><tr><td align="center">4</td><td align="center">Snipaste</td><td>截图</td></tr><tr><td align="center"></td><td align="center"></td><td></td></tr><tr><td align="center"></td><td align="center"></td><td></td></tr></tbody></table><h3 id="A3-培训环境"><a href="#A3-培训环境" class="headerlink" title="A3. 培训环境"></a>A3. 培训环境</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> /etc/rht</span><br><span class="line">RHT_COURSE=rh358</span><br><span class="line">RHT_TITLE=<span class="string">&quot;Management and Automation of Linux Network Services (RH358)&quot;</span></span><br><span class="line">RHT_VMS=<span class="string">&quot;bastion workstation servera serverb serverc serverd &quot;</span></span><br><span class="line">RHT_VM0=<span class="string">&quot;classroom &quot;</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="center">虚拟机</th><th align="center">主机名</th><th align="center">功能</th><th align="center">必须</th><th align="center">root</th><th align="center">User</th></tr></thead><tbody><tr><td align="center">VMware</td><td align="center">foundation</td><td align="center">平台</td><td align="center">1</td><td align="center">Asimov</td><td align="center">kiosk%redhat</td></tr><tr><td align="center">KVM</td><td align="center">classroom</td><td align="center">功能服务器</td><td align="center">1</td><td align="center">Asimov</td><td align="center">instructor%Asimov</td></tr><tr><td align="center">KVM</td><td align="center">bastion</td><td align="center">router</td><td align="center">1</td><td align="center">redhat</td><td align="center">student%student</td></tr><tr><td align="center">KVM</td><td align="center">workstation</td><td align="center">GUI</td><td align="center">0</td><td align="center">redhat</td><td align="center">student%student</td></tr><tr><td align="center">KVM</td><td align="center">server{a..d}</td><td align="center">CLI</td><td align="center">0</td><td align="center">redhat</td><td align="center">student%student</td></tr></tbody></table><p><strong>[kiosk@foundation]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ rht-vmctl start classroom</span><br><span class="line">$ rht-vmctl start bastion</span><br><span class="line">$ rht-vmctl start workstation</span><br><span class="line">$ rht-vmctl start servera</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ping -c 4 workstation</span><br><span class="line">$ ssh root@workstation</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> /content/slides/</span><br></pre></td></tr></table></figure><h3 id="A4-yaml"><a href="#A4-yaml" class="headerlink" title="A4. yaml"></a>A4. yaml</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ansible-doc -l | grep keyword</span><br><span class="line">$ ansible-doc module-name</span><br><span class="line">/EX</span><br><span class="line"></span><br><span class="line">$ ansible-playbook x.yml</span><br></pre></td></tr></table></figure><blockquote><ul><li><code>---</code>第一行</li><li>使用<code>缩进</code>表示层级关系，<code>:</code>上一级以冒号结尾</li><li>只允许<code>空格</code>，缩进不允许使用tab</li><li>缩进的空格数不重要，只要相同层级的元素左对齐即可</li><li><code>#</code>表示注释</li><li><code>key</code>:空格<code>value</code></li></ul></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tail -n 1 /etc/bashrc</span></span><br><span class="line"><span class="comment"># vim</span></span><br><span class="line">:<span class="built_in">set</span> all</span><br><span class="line">:<span class="built_in">help</span> tabstop</span><br><span class="line"></span><br><span class="line"><span class="comment"># ls /etc/vimrc ~/.vimrc</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cat</span> &gt; ~/.vimrc &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">set number ts=2 sw=2 et</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h3 id="A5-service"><a href="#A5-service" class="headerlink" title="A5. service"></a>A5. service</h3><table><thead><tr><th align="center">STEP</th><th>CMD</th><th>COMMENT</th><th></th></tr></thead><tbody><tr><td align="center">1</td><td>nmcli | nmtui</td><td>网络</td><td></td></tr><tr><td align="center">2</td><td>hostnamectl</td><td>主机名</td><td></td></tr><tr><td align="center">3</td><td>yum search KEYWORD</td><td>查安装包名</td><td>dns</td></tr><tr><td align="center">4</td><td>yum -y install PKG</td><td>安装软件</td><td>bind</td></tr><tr><td align="center">5</td><td>rpm -qc PKG | man -k nfs</td><td>查配置文件</td><td>bind</td></tr><tr><td align="center">6</td><td>vim &#x2F;etc&#x2F;..cfg(sec_service)</td><td>编辑(安全1&#x2F;4)</td><td>&#x2F;etc&#x2F;named.conf</td></tr><tr><td align="center">7</td><td>rpm -ql PKG | grep service<br>systemctl list-unit-files | grep KEYWORD</td><td>查守护进程</td><td>bind</td></tr><tr><td align="center">8</td><td>systemctl enable –now DAEMON<br>systemctl restart DAEMON</td><td>开机自启，立即启动</td><td>named</td></tr><tr><td align="center">9</td><td>firewall-cmd –permanent …, <br>–reload(sec_port)</td><td>防火墙(安全1&#x2F;4)</td><td></td></tr><tr><td align="center">10</td><td></td><td>文件系统(安全1&#x2F;4)</td><td></td></tr><tr><td align="center">11</td><td></td><td>SELinux(安全1&#x2F;4)</td><td></td></tr></tbody></table><h3 id="A6-OBJECTIVE-SCORE"><a href="#A6-OBJECTIVE-SCORE" class="headerlink" title="A6. OBJECTIVE: SCORE"></a>A6. OBJECTIVE: SCORE</h3><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Manage Network Services: 87%</span><br><span class="line">Manage Firewall Services: 100%</span><br><span class="line">Manage SELinux: 100%</span><br><span class="line">Manage DNS: 0%</span><br><span class="line">Manage DHCP: 100%</span><br><span class="line">Manage printers: 33%</span><br><span class="line">Manage Email services: 100%</span><br><span class="line">Manage a MariaDB database server: 100%</span><br><span class="line">Manage HTTPD web access: 100%</span><br><span class="line">Manage iSCSI: 50%</span><br><span class="line">Manage NFS: 100%</span><br><span class="line">Manage SMB: 75%</span><br><span class="line">Use Ansible to Configure Standard Services: 80%</span><br></pre></td></tr></table></figure></blockquote><h3 id="A7-学习技巧"><a href="#A7-学习技巧" class="headerlink" title="A7. 学习技巧"></a>A7. 学习技巧</h3><blockquote><ul><li><p>word</p></li><li><p><kbd>Tab</kbd> 补全,<kbd>Tab</kbd><kbd>Tab</kbd> 列出 </p></li><li><p>&#96;&#96;&#96;bash</p></li></ul><h1 id="man-command"><a href="#man-command" class="headerlink" title="man command"></a>man command</h1>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- ```bash</span><br><span class="line">  # echo $?</span><br></pre></td></tr></table></figure></blockquote><h3 id="A8-VMware-software"><a href="#A8-VMware-software" class="headerlink" title="A8. VMware+software"></a>A8. VMware+software</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum -y install \</span></span><br><span class="line">open-vm-tools-desktop.x86_64 \</span><br><span class="line">xorg-x11-drv-vmware.x86_64</span><br></pre></td></tr></table></figure><h3 id="A9-ansible"><a href="#A9-ansible" class="headerlink" title="A9. ansible"></a>A9. ansible</h3><p><strong>[student@workstation]</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ yum search ansible</span><br><span class="line">$ yum list ansible</span><br><span class="line"></span><br><span class="line">$ rpm -qc ansible</span><br><span class="line">/etc/ansible/ansible.cfg</span><br><span class="line">/etc/ansible/hosts</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">head</span> /etc/ansible/ansible.cfg</span><br><span class="line">$ <span class="built_in">mkdir</span> playbook</span><br><span class="line">$ <span class="built_in">cp</span> /etc/ansible/ansible.cfg playbook/ansible.cfg</span><br><span class="line">$ <span class="built_in">cd</span> playbook/</span><br><span class="line">$ ansible --version</span><br><span class="line"></span><br><span class="line">$ vim /home/student/playbook/ansible.cfg</span><br><span class="line">...</span><br><span class="line">inventory      = /home/student/playbook/inventory</span><br><span class="line">$ <span class="built_in">cp</span> /etc/ansible/hosts inventory</span><br><span class="line">$ ansible-inventory --graph</span><br></pre></td></tr></table></figure><blockquote><p><strong>module</strong></p><ul><li>stat(when)</li><li>debug(echo)</li><li>setup(facts)</li><li>shell(*,|)</li><li>command(id, hostname)</li></ul></blockquote><h3 id="A10-vim"><a href="#A10-vim" class="headerlink" title="A10. vim"></a>A10. vim</h3><table><thead><tr><th align="center">ID</th><th></th><th></th></tr></thead><tbody><tr><td align="center">1</td><td><kbd>u</kbd></td><td>Undo</td></tr><tr><td align="center">2</td><td><kbd>5</kbd><kbd>g</kbd><kbd>g</kbd></td><td>Go</td></tr><tr><td align="center">3</td><td><kbd>Ctrl</kbd>-<kbd>V</kbd></td><td>Virtual block</td></tr><tr><td align="center">4</td><td><kbd>j</kbd>* n</td><td>:arrow_down:</td></tr><tr><td align="center">5</td><td><kbd>I</kbd></td><td>III12iii<u>3</u>aaa456AAA</td></tr><tr><td align="center">6</td><td><kbd>Esc</kbd></td><td></td></tr><tr><td align="center">7</td><td><kbd>o</kbd></td><td>Open</td></tr><tr><td align="center">8</td><td><kbd>x</kbd></td><td></td></tr><tr><td align="center"></td><td></td><td></td></tr></tbody></table><h3 id="A11-培训环境-2-练习环境"><a href="#A11-培训环境-2-练习环境" class="headerlink" title="A11. 培训环境 2 练习环境"></a>A11. 培训环境 2 练习环境</h3><blockquote><p>VMware</p><ul><li><a href="https://ark.intel.com/">CPU</a> * 8</li><li>MEM * 8G</li></ul></blockquote><table><thead><tr><th align="center">STEP</th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">1</td><td align="center">VMware 第一次运行时</td><td align="center">选择<code>已移动</code></td></tr><tr><td align="center">2</td><td align="center">物理机 vmnet1</td><td align="center">172.25.254.<code>1</code>&#x2F;24</td></tr><tr><td align="center">3</td><td align="center">X:\&gt; <code>ping 172.25.254.250</code></td><td align="center">物理机：确认和 foundation连网</td></tr><tr><td align="center">4</td><td align="center">X:\&gt; <code>scp YOURPATH/ex358.rar kiosk@172.25.254.250:~</code></td><td align="center">物理机：拷贝文件</td></tr><tr><td align="center">5</td><td align="center">$ <code>unzip ex358.zip</code></td><td align="center">解压缩</td></tr><tr><td align="center">6</td><td align="center">$ <code>bash ex358/exam-setup.sh</code></td><td align="center">开始布署，约6分钟</td></tr><tr><td align="center">7</td><td align="center"># <code>systemctl shudown</code></td><td align="center">关机</td></tr><tr><td align="center">8</td><td align="center"></td><td align="center">做快照，名称<code>EX358</code></td></tr><tr><td align="center">9</td><td align="center"></td><td align="center">开机</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ rht-vmctl status classroom</span><br><span class="line">classroom RUNNING</span><br><span class="line">$ rht-vmctl status all</span><br><span class="line">bastion DEFINED</span><br><span class="line">workstation DEFINED</span><br><span class="line">servera DEFINED</span><br><span class="line">serverb DEFINED</span><br><span class="line">serverc DEFINED</span><br><span class="line">serverd DEFINED</span><br><span class="line">$ rht-vmctl start bastion</span><br><span class="line"></span><br><span class="line">-CMD</span><br><span class="line">$ rht-vmctl start servera</span><br><span class="line">$ rht-vmctl start serverb</span><br><span class="line"></span><br><span class="line">-ANSIBLE</span><br><span class="line">$ rht-vmctl start workstation</span><br><span class="line">$ rht-vmctl start serverc</span><br><span class="line">$ rht-vmctl start serverd</span><br></pre></td></tr></table></figure><h4 id="A12-PC-VMware"><a href="#A12-PC-VMware" class="headerlink" title="A12. PC+VMware"></a>A12. PC+VMware</h4><table><thead><tr><th align="center">OS</th><th></th><th></th></tr></thead><tbody><tr><td align="center">win7</td><td>VMware-workstation-full-15.5.7</td><td>1、删除快照<br>2、改兼容性<br>3、改CPU+MEM</td></tr><tr><td align="center">win&gt;&#x3D;8</td><td>VMware-workstation-full-16.1.2</td><td></td></tr></tbody></table><blockquote><p>CPU: AMD</p><p>foundation 8.0 +RH358<br>foundation 8.2</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RHCA学习笔记|CL210</title>
      <link href="/2022/07/12/RHCA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-CL210/"/>
      <url>/2022/07/12/RHCA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-CL210/</url>
      
        <content type="html"><![CDATA[<h1 id="CL210-OpenStack"><a href="#CL210-OpenStack" class="headerlink" title="CL210 OpenStack"></a>CL210 OpenStack</h1><p><img src="https://i.loli.net/2021/11/30/8l9zAxQ5Ff1dGWT.png" alt="image-20211120205949927"></p><ul><li><p>课程的实验环境：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1     classroom            </span><br><span class="line">2     workstation                   </span><br><span class="line">3     power          虚拟的ipmi服务器</span><br><span class="line">4     utility        IPA服务器</span><br><span class="line">5     director       undercloud</span><br><span class="line">6     controller0    控制节点                 </span><br><span class="line">7     ceph0          存储节点                </span><br><span class="line">8     computehci0    超融合的计算节点</span><br><span class="line">9     compute0       计算节点</span><br><span class="line">10    compute1       计算节点</span><br></pre></td></tr></table></figure></li><li><p>课程目的</p><p>基于openstack创建一个云主机并为其提供服务</p></li></ul><h1 id="第一章-openStack的安装"><a href="#第一章-openStack的安装" class="headerlink" title="第一章 openStack的安装"></a>第一章 openStack的安装</h1><blockquote><ul><li>一些概念：</li></ul><p><a href="https://cloud.tencent.com/developer/article/1041633">XEN、VMware ESXi、Hyper-V以及KVM架构解析</a></p><p><a href="https://zhidao.baidu.com/question/584394281.html">IaaS, PaaS和SaaS及其区别</a></p><p><a href="https://www.redhat.com/zh/topics/cloud-computing/cloud-vs-virtualization">虚拟化和云的区别</a></p></blockquote><ol><li><p>OpenStack是什么？基于IAAS的私有云管理平台  —-&gt;目的: 创建和管理云主机</p><p>（OpenShift是基于PAAS层）</p></li><li><p>OpenStack的简易（最小化）架构： 至少 1个控制节点 + 1个计算节点（虚拟化服务器）</p></li></ol><blockquote><p>实际工作中需要考虑控制节点的高可用（以防出现故障）</p></blockquote><p>  虚拟化： 纵向扩展<br>  云计算： 横向扩展   vcpu  虚拟内存</p><blockquote><ul><li><code>横向扩展</code> 也叫 <code>水平扩展</code>，用更多的节点支撑更大量的请求。 如成千上万的蚂蚁完成一项搬运工作</li><li><code>纵向扩展</code> 又叫 <code>垂直扩展</code>，扩展一个点的能力支撑更大的请求。如利用1个人的能力，如蜘蛛侠逼停火车</li></ul></blockquote><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><blockquote><ol><li><p>packstack安装  —–&gt; POC（概念验证，用于测试，演示，不适用于生产） all in one(新手推荐安装方式）</p><p><a href="https://blog.csdn.net/weixin_41831919/article/details/109035936">epel-release</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">epel：红帽官方为企业级linux（EL）提供的额外软件（extra package）包</span></span><br><span class="line">yum install epel-release</span><br><span class="line">yum install centos-release-openstack-victoria</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">包含openstack-packstack-puppet.noarch，类似于ansible</span></span><br><span class="line">yum install openstack-packstack</span><br><span class="line"></span><br><span class="line">基于packstack创建并修改自动应答文件：</span><br><span class="line">packstack --gen-answer-file a.txt</span><br><span class="line">packstack --answer-file a.txt</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://www.yuque.com/docs/share/ae18d053-503d-4ac0-be36-4faec656e7aa#%20%E3%80%8Aopenstack%20V%E7%89%88%20%E4%BD%BF%E7%94%A8packstack%E5%AE%89%E8%A3%85%EF%BC%9A%E3%80%8B">老师自己写的文档</a>：</p><h1 id="安装前的准备："><a href="#安装前的准备：" class="headerlink" title="安装前的准备："></a>安装前的准备：</h1><h2 id="1-关闭防火墙和selinux"><a href="#1-关闭防火墙和selinux" class="headerlink" title="1. 关闭防火墙和selinux"></a>1. 关闭防火墙和selinux</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@openstack ~]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@openstack ~]<span class="comment"># systemctl disabled firewalld</span></span><br><span class="line">[root@openstack ~]<span class="comment"># sed -i &#x27;s/SELINUX=enforcing/SELINUX=disabled/g&#x27; /etc/selinux/config</span></span><br></pre></td></tr></table></figure><h2 id="2-安装必要的包"><a href="#2-安装必要的包" class="headerlink" title="2. 安装必要的包"></a>2. 安装必要的包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install bash-completion wget vim curl net-tools</span><br></pre></td></tr></table></figure><h2 id="3-设置主机名"><a href="#3-设置主机名" class="headerlink" title="3. 设置主机名"></a>3. 设置主机名</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 一定要配置</span></span><br><span class="line">[root@openstack ~]<span class="comment"># vim /etc/hosts</span></span><br><span class="line">192.168.26.100  openstack.example.com</span><br><span class="line"></span><br><span class="line">[root@openstack ~]<span class="comment"># hostnamctl set-hostname openstack.example.com</span></span><br></pre></td></tr></table></figure><h2 id="4-配置静态IP地址"><a href="#4-配置静态IP地址" class="headerlink" title="4. 配置静态IP地址"></a>4. 配置静态IP地址</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## openstack不支持NetworkManager，所以要停掉</span></span><br><span class="line">[root@openstack ~]<span class="comment"># systemctl disable NetworkManager</span></span><br><span class="line">[root@openstack ~]<span class="comment"># systemctl stop NetworkManager</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum install network-scripts -y</span></span><br><span class="line">[root@openstack ~]<span class="comment"># systemctl start network &amp;&amp; systemctl enable network</span></span><br><span class="line"></span><br><span class="line">[root@openstack ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-ens33</span></span><br><span class="line">IPADDR=192.168.26.100</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.26.2</span><br><span class="line">DNS1=192.168.26.2</span><br><span class="line"></span><br><span class="line">[root@openstack ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-ens37</span></span><br><span class="line">IPADDR=10.0.0.1</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><h1 id="openstack安装"><a href="#openstack安装" class="headerlink" title="openstack安装"></a>openstack安装</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 启用电源模块</span></span><br><span class="line">[root@openstack ~]<span class="comment"># dnf config-manager --enable powertools</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum install centos-release-openstack-victoria -y</span></span><br><span class="line"><span class="comment">## 严格保证安装最新版版</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum update -y</span></span><br><span class="line">[root@openstack ~]<span class="comment"># reboot</span></span><br></pre></td></tr></table></figure><h2 id="生成自动应答文件"><a href="#生成自动应答文件" class="headerlink" title="生成自动应答文件"></a>生成自动应答文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 坑，必须移除epel，不然可能有个依赖包过不去（老师说的，不知道啥意思）</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum autoremove epel-release</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum autoremove openstack-packstack</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum clean all</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum install -y openstack-packstack</span></span><br><span class="line">[root@openstack ~]<span class="comment"># yum install openstack-packstack -y</span></span><br><span class="line">[root@openstack ~]<span class="comment"># packstack --gen-answer-file aa.txt</span></span><br><span class="line">[root@openstack ~]<span class="comment"># vim aa.txt</span></span><br><span class="line"><span class="comment">## 是否生成一个自动演示的实例（浪费时间）</span></span><br><span class="line">CONFIG_PROVISION_DEMO=n</span><br><span class="line"><span class="comment">## 图形化界面管理员密码（自动生成的是随机的乱码）</span></span><br><span class="line">CONFIG_KEYSTONE_ADMIN_PW=redhat</span><br><span class="line"><span class="comment">## 网络使用类型（不改就使用ovn了）</span></span><br><span class="line">CONFIG_NEUTRON_L2_AGENT=openvswitch</span><br><span class="line"><span class="comment">## 外网网卡</span></span><br><span class="line">CONFIG_NEUTRON_OVS_BRIDGE_IFACES=br-ex:ens33</span><br><span class="line"><span class="comment">## 支持的网络类型</span></span><br><span class="line">CONFIG_NEUTRON_ML2_TYPE_DRIVERS=geneve,flat,vxlan</span><br><span class="line">CONFIG_NEUTRON_ML2_TENANT_NETWORK_TYPES=vxlan</span><br><span class="line"><span class="comment">## 虚拟交换机</span></span><br><span class="line">CONFIG_NEUTRON_ML2_MECHANISM_DRIVERS=openvswitch</span><br><span class="line"><span class="comment">## 扁平网络的名字</span></span><br><span class="line">CONFIG_NEUTRON_ML2_FLAT_NETWORKS=datacentre</span><br><span class="line"></span><br><span class="line">[root@openstack ~]<span class="comment"># packstack --answer-file aa.txt</span></span><br><span class="line">Welcome to the Packstack setup utility</span><br><span class="line"></span><br><span class="line">The installation <span class="built_in">log</span> file is available at: /var/tmp/packstack/20210922-010500-85phzhks/openstack-setup.log</span><br><span class="line"></span><br><span class="line">Installing:</span><br><span class="line">Clean Up                                             [ DONE ]</span><br><span class="line">Discovering ip protocol version                      [ DONE ]</span><br><span class="line">Setting up ssh keys                                  [ DONE ]</span><br><span class="line">Preparing servers                                    [ DONE ]</span><br><span class="line">Pre installing Puppet and discovering hosts<span class="string">&#x27; details [ DONE ]</span></span><br><span class="line"><span class="string">Preparing pre-install entries                        [ DONE ]</span></span><br><span class="line"><span class="string">Setting up CACERT                                    [ DONE ]</span></span><br><span class="line"><span class="string">...........</span></span><br><span class="line"><span class="string">等待约10到20分钟安装完成！</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**** Installation completed successfully ******</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Additional information:</span></span><br><span class="line"><span class="string"> * Time synchronization installation was skipped. Please note that unsynchronized time on server instances might be problem for some OpenStack components.</span></span><br><span class="line"><span class="string"> * File /root/keystonerc_admin has been created on OpenStack client host 192.168.26.100. To use the command line tools you need to source the file.</span></span><br><span class="line"><span class="string"> * To access the OpenStack Dashboard browse to http://192.168.26.100/dashboard .</span></span><br><span class="line"><span class="string">Please, find your login credentials stored in the keystonerc_admin in your home directory.</span></span><br><span class="line"><span class="string"> * The installation log file is available at: /var/tmp/packstack/20210922-010500-85phzhks/openstack-setup.log</span></span><br><span class="line"><span class="string"> * The generated manifests are available at: /var/tmp/packstack/20210922-010500-85phzhks/manifests</span></span><br></pre></td></tr></table></figure><h2 id="安装和错误参考："><a href="#安装和错误参考：" class="headerlink" title="安装和错误参考："></a>安装和错误参考：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/dyd168/p/14454518.html</span><br><span class="line">https://blog.csdn.net/qq_25650463/article/details/114981776</span><br><span class="line">https://ibmimedia.com/blog/1142/error-function-lookup-did-not-find-a-value-for-the-name-default-exec-timeout</span><br></pre></td></tr></table></figure><h1 id="添加一个计算节点"><a href="#添加一个计算节点" class="headerlink" title="添加一个计算节点"></a>添加一个计算节点</h1><p>还没写</p></blockquote></li><li><p>进阶  命令行安装  一个组件一个组件的装（支持ansible安装，适用于生产）</p><p>参考<a href="openstack.org">官网文档</a></p></li><li><p>redhat OpenStack架构 （适用于生产）</p><p>基于tripleO项目（装包时有一个叫tripleo相关的包）： </p><p>核心：OOOopenstack      on     openstack<br>                          <strong>undercloud</strong>                <strong>overcloud</strong><br>安装、升级、管理都在undercloud（director）进行       实际生产工作的openstack         </p><p>​<a href="https://blog.csdn.net/bcfdsagbfcisbg/article/details/76862044">PXE</a>安装（undercloud通过PXE引导安装overcloud）</p><p>​<a href="https://www.jianshu.com/p/f0366f577e95">ipmi</a> 做电源管理（开机，关机，需要以太网卡支持ipmi协议）</p></li></ol></blockquote><h2 id="了解openstack的核心组件"><a href="#了解openstack的核心组件" class="headerlink" title="了解openstack的核心组件"></a>了解openstack的核心组件</h2><blockquote><p><code>keystone</code>: 身份验证<br><code>glance</code>：管理OpenStack的镜像（就是已经安装好OS或者应用的虚拟机的虚拟磁盘文件）<br><code>cinder</code>：块存储服务  给云主机来提供块存储服务  附加存储 只能同时由一个云主机访问<br><code>neutron</code>：云上私网   提供软件定义的网络<br><code>nova</code>：计算服务  资源的大管家  nova-compute nova-controlleber<br><code>dashboard</code>: web管理openstack<br><code>swift</code>: 对象存储服务 存储是非结构化数据 资源通过链接来分享 哈希去重 秒传 三副本机制<br><code>heat</code>: 自动化管理 批量的创建云主机<br><code>ceilmeter</code>： 监控和计费</p></blockquote><h2 id="依赖几个额外的组件"><a href="#依赖几个额外的组件" class="headerlink" title="依赖几个额外的组件"></a>依赖几个额外的组件</h2><blockquote><ol><li>数据库：mariadb&#x2F;mysql</li><li>rabbitmq-server  消息队列  提供标准的AMQP协议</li><li>redis  键值数据库</li><li>memcached  缓存</li><li>pacemaker  高可用集群</li><li>docker     所有的组件是以容器的形式来运行</li></ol></blockquote><h2 id="如果要实现最小化的openstack架构，至少需要哪几个组件？"><a href="#如果要实现最小化的openstack架构，至少需要哪几个组件？" class="headerlink" title="如果要实现最小化的openstack架构，至少需要哪几个组件？"></a>如果要实现最小化的openstack架构，至少需要哪几个组件？</h2><blockquote><p>keystone </p><p>glance  </p><p>neutron  </p><p>nova </p></blockquote><h2 id="启动实验环境的虚拟机："><a href="#启动实验环境的虚拟机：" class="headerlink" title="启动实验环境的虚拟机："></a>启动实验环境的虚拟机：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@foundation0 ~]# rht-vmctl fullreset all</span><br><span class="line">[root@foundation0 ~]# ssh stack@director</span><br><span class="line">(undercloud) [stack@director ~]$ rht-overcloud.sh start</span><br></pre></td></tr></table></figure><h2 id="容器的问题"><a href="#容器的问题" class="headerlink" title="容器的问题:"></a>容器的问题:</h2><blockquote><p>容器是什么？本质是OS上的一个进程  </p><p>器是不是虚拟化？是   操作系统虚拟化   内核支持容器技术就可以通过容器来封装应用  开箱即用  —-&gt;实现自动化运维  —–&gt; 云原生</p><p>三要素：镜像  容器  镜像仓库</p></blockquote><h2 id="如果要修改应用的配置文件："><a href="#如果要修改应用的配置文件：" class="headerlink" title="如果要修改应用的配置文件："></a>如果要修改应用的配置文件：</h2><blockquote><h3 id="方法1-登录容器："><a href="#方法1-登录容器：" class="headerlink" title="方法1. 登录容器："></a>方法1. 登录容器：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller0 ~]<span class="comment"># docker exec -it horizon bash</span></span><br></pre></td></tr></table></figure><h3 id="方法2："><a href="#方法2：" class="headerlink" title="方法2："></a>方法2：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@controller0 ~]# cd /var/lib/config-data/puppet-generated/</span><br></pre></td></tr></table></figure></blockquote><h2 id="实验：图形化创建一个实例"><a href="#实验：图形化创建一个实例" class="headerlink" title="实验：图形化创建一个实例"></a>实验：图形化创建一个实例</h2><p>如果dashboard报500错误，登录controller0 重启容器： docker restart horizon</p><blockquote><ol><li><p>创建租户project   </p></li><li><p>创建用户 跟project对应 （user1已经授权admin角色）</p></li><li><p>用创建好的用户登录</p></li><li><p>先创建flavor(规格）admin创建  </p></li><li><p>上传镜像  </p></li><li><p>创建网络 </p><ol><li>创建云上网络 VPC网络  </li><li>创建物理网络（admin创建） 做浮动IP 先删除原来的172.25的物理网络，再新建物理网络<br>子网：172.25.250.0&#x2F;24  类型：flat  名字：datacentre  网关： 172.25.250.0&#x2F;24</li></ol></li><li><p>创建路由器，管理内网和外网</p></li><li><p>创建安全组和SSH密钥</p></li><li><p>创建实例并绑定浮动IP</p></li><li><p>ssh登录访问  测试用户cloud-user能否登录云主机</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 key1.pem</span><br><span class="line">ssh -i key1.pem cloud-user@172.25.250.104</span><br></pre></td></tr></table></figure></li></ol></blockquote><h1 id="第二章-keystone和消息队列"><a href="#第二章-keystone和消息队列" class="headerlink" title="第二章 keystone和消息队列"></a>第二章 keystone和消息队列</h1><ol><li><p>keystone的要素</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">user  service  endpoint</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">openstack user create --domain default --password-prompt glance</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">openstack service create --name glance --description <span class="string">&quot;OpenStack Image&quot;</span> image</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">openstack endpoint create --region RegionOne image public http://controller:9292</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(overcloud) [stack@director ~]$ openstack catalog show nova</span><br><span class="line">+-----------+------------------------------------------+</span><br><span class="line">| Field     | Value                                    |</span><br><span class="line">+-----------+------------------------------------------+</span><br><span class="line">| endpoints | regionOne                                |</span><br><span class="line">|           |   admin: http://172.24.1.50:8774/v2.1    |</span><br><span class="line">|           | regionOne                                |</span><br><span class="line">|           |   public: http://17